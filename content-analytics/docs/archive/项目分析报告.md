# é¡¹ç›®åˆ†ææŠ¥å‘Š

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**å†…å®¹è´¦å·æ•°æ®åˆ†æ + AI è¾…åŠ©å†³ç­–ç³»ç»Ÿ**ï¼Œç”¨äºåˆ†æç¤¾äº¤åª’ä½“ï¼ˆå¦‚å°çº¢ä¹¦ï¼‰ç¬”è®°æ•°æ®ï¼Œå¹¶é€šè¿‡ AI ç”Ÿæˆä¼˜åŒ–å»ºè®®ã€‚

**æ ¸å¿ƒä¸šåŠ¡æµç¨‹ï¼š**
```
ç”¨æˆ·ç™»å½• â†’ ä¸Šä¼ Excelæ•°æ® â†’ æ•°æ®è§£æå…¥åº“ â†’ æ•°æ®åˆ†æ(éAI) â†’ AIç”Ÿæˆå»ºè®® â†’ å±•ç¤ºç»“æœ â†’ å¯¼å‡ºæŠ¥å‘Š
```

**ä¸»è¦åŠŸèƒ½æ¨¡å—ï¼š**
- ğŸ“Š æ•°æ®é›†ç®¡ç† - Excelä¸Šä¼ ã€è§£æã€å­˜å‚¨
- ğŸ“ˆ æ•°æ®åˆ†æ - æŒ‡æ ‡è®¡ç®—ã€å¼‚å¸¸æ£€æµ‹ã€æ€§èƒ½è¯„çº§
- ğŸ¤– AIåˆ†æ - å¤šProvideræ”¯æŒã€æµå¼å¯¹è¯
- ğŸ’¬ AIå¯¹è¯ - åŸºäºåˆ†æç»“æœçš„æ™ºèƒ½é—®ç­”
- ğŸ“¸ æˆªå›¾åˆ†æ - ç½‘é¡µæˆªå›¾å†…å®¹åˆ†æ
- ğŸ“¥ æŠ¥å‘Šå¯¼å‡º - Excel/PDFæ ¼å¼å¯¼å‡º

---

## æŠ€æœ¯æ ˆè¯¦æƒ…

### åç«¯æŠ€æœ¯æ ˆ
| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| Webæ¡†æ¶ | FastAPI | 0.109.0 |
| æ•°æ®åº“ | PostgreSQL + asyncpg | 15 / 0.29.0 |
| ORM | SQLAlchemy | 2.0.25 |
| æ•°æ®è¿ç§» | Alembic | 1.13.1 |
| å¼‚æ­¥ä»»åŠ¡ | Celery + Redis | 5.3.6 / 7 |
| è®¤è¯ | JWT (python-jose) + BCrypt | 3.3.0 |
| æ•°æ®å¤„ç† | pandas + openpyxl + numpy | 2.2.0 / 3.1.2 / 1.26.3 |
| HTTPå®¢æˆ·ç«¯ | httpx | 0.26.0 |
| AI SDK | openai | 1.10.0 |
| ç½‘é¡µçˆ¬è™« | playwright + beautifulsoup4 | 1.57.0 / 4.12.3 |

### å‰ç«¯æŠ€æœ¯æ ˆ
| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| æ¡†æ¶ | Vue 3 + TypeScript | 3.4.15 / 5.3.3 |
| æ„å»ºå·¥å…· | Vite | 5.0.11 |
| UIç»„ä»¶åº“ | Element Plus | 2.5.3 |
| çŠ¶æ€ç®¡ç† | Pinia | 2.1.7 |
| è·¯ç”± | Vue Router | 4.2.5 |
| HTTPå®¢æˆ·ç«¯ | Axios | 1.6.5 |
| å›¾è¡¨ | ECharts + vue-echarts | 5.4.3 / 6.6.8 |
| æ—¥æœŸå¤„ç† | dayjs | 1.11.10 |
| æ ·å¼ | SCSS | 1.70.0 |

### AI Provider æ”¯æŒ
| Provider | æ¨¡å‹ | ç‰¹ç‚¹ |
|----------|------|------|
| DeepSeek | deepseek-chat | é»˜è®¤Providerï¼Œæ€§ä»·æ¯”é«˜ |
| OpenAI | gpt-3.5-turbo / gpt-4 | å…¼å®¹API |
| iFlow | kimi-k2-0905 | Kimiæ¨¡å‹ï¼Œå›½å†…è®¿é—®å‹å¥½ |

### éƒ¨ç½²æŠ€æœ¯æ ˆ
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **åå‘ä»£ç†**: Nginx
- **æ•°æ®åº“**: PostgreSQL 15 (ç«¯å£ 5433)
- **ç¼“å­˜/é˜Ÿåˆ—**: Redis 7 (ç«¯å£ 6380)

---

## ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å‰ç«¯ (Vue 3 + TypeScript)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Login   â”‚ â”‚ Datasets â”‚ â”‚ Analyses â”‚ â”‚   Chat   â”‚ â”‚ Settings â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                              Pinia Store + Vue Router                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚ HTTP/REST API + SSE (æµå¼)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         åç«¯ (FastAPI)                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        API Routes (/api/v1)                      â”‚   â”‚
â”‚  â”‚  auth â”‚ datasets â”‚ analyses â”‚ posts â”‚ exports â”‚ chat â”‚ settings â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                  â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Services   â”‚  â”‚   Analysis   â”‚  â”‚  AI Layer    â”‚                  â”‚
â”‚  â”‚  ä¸šåŠ¡é€»è¾‘å±‚   â”‚  â”‚  æ•°æ®åˆ†ææ¨¡å— â”‚  â”‚  Providerå±‚  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚         â”‚                  â”‚                  â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚                    Models (SQLAlchemy)              â”‚                â”‚
â”‚  â”‚  User â”‚ Dataset â”‚ Post â”‚ Analysis â”‚ Conversation   â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                           â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚              Celery Tasks (å¼‚æ­¥ä»»åŠ¡)                 â”‚               â”‚
â”‚  â”‚  dataset_tasks â”‚ analysis_tasks â”‚ ai_tasks â”‚ export â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL   â”‚   â”‚     Redis     â”‚   â”‚   AI APIs     â”‚
â”‚   æ•°æ®å­˜å‚¨     â”‚   â”‚  é˜Ÿåˆ—/ç¼“å­˜    â”‚   â”‚ DeepSeek/GPT  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç›®å½•ç»“æ„è¯¦è§£

### åç«¯ç»“æ„ (`/backend`)
```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/                    # API è·¯ç”±å±‚
â”‚   â”‚   â”œâ”€â”€ deps.py             # ä¾èµ–æ³¨å…¥ (get_current_user, get_db)
â”‚   â”‚   â””â”€â”€ v1/                 # API v1 ç‰ˆæœ¬
â”‚   â”‚       â”œâ”€â”€ __init__.py     # è·¯ç”±æ³¨å†Œ
â”‚   â”‚       â”œâ”€â”€ auth.py         # è®¤è¯: register, login, me
â”‚   â”‚       â”œâ”€â”€ datasets.py     # æ•°æ®é›†: upload, list, detail, delete
â”‚   â”‚       â”œâ”€â”€ analyses.py     # åˆ†æ: create, list, results, ai
â”‚   â”‚       â”œâ”€â”€ posts.py        # ç¬”è®°: detail, ai-output
â”‚   â”‚       â”œâ”€â”€ exports.py      # å¯¼å‡º: create, download
â”‚   â”‚       â”œâ”€â”€ chat.py         # å¯¹è¯: conversations, messages (æµå¼)
â”‚   â”‚       â”œâ”€â”€ screenshots.py  # æˆªå›¾åˆ†æ
â”‚   â”‚       â””â”€â”€ settings.py     # è®¾ç½®: AIé…ç½®, æµ‹è¯•è¿æ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                 # SQLAlchemy ORM æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py         # æ¨¡å‹å¯¼å‡º
â”‚   â”‚   â”œâ”€â”€ user.py             # User ç”¨æˆ·è¡¨
â”‚   â”‚   â”œâ”€â”€ dataset.py          # Dataset æ•°æ®é›†è¡¨
â”‚   â”‚   â”œâ”€â”€ post.py             # Post ç¬”è®°è¡¨
â”‚   â”‚   â”œâ”€â”€ analysis.py         # Analysis, AnalysisResult, AIOutput
â”‚   â”‚   â”œâ”€â”€ export.py           # Export å¯¼å‡ºè®°å½•è¡¨
â”‚   â”‚   â”œâ”€â”€ user_settings.py    # UserSettings ç”¨æˆ·è®¾ç½®è¡¨
â”‚   â”‚   â”œâ”€â”€ conversation.py     # Conversation, ConversationMessage
â”‚   â”‚   â””â”€â”€ screenshot.py       # ScreenshotAnalysis æˆªå›¾åˆ†æè¡¨
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                # Pydantic è¯·æ±‚/å“åº”æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ user.py             # ç”¨æˆ·ç›¸å…³ schema
â”‚   â”‚   â”œâ”€â”€ dataset.py          # æ•°æ®é›†ç›¸å…³ schema
â”‚   â”‚   â”œâ”€â”€ post.py             # ç¬”è®°ç›¸å…³ schema
â”‚   â”‚   â”œâ”€â”€ analysis.py         # åˆ†æç›¸å…³ schema
â”‚   â”‚   â”œâ”€â”€ conversation.py     # å¯¹è¯ç›¸å…³ schema
â”‚   â”‚   â”œâ”€â”€ settings.py         # è®¾ç½®ç›¸å…³ schema
â”‚   â”‚   â””â”€â”€ common.py           # é€šç”¨å“åº”æ¨¡å‹ ResponseModel
â”‚   â”‚
â”‚   â”œâ”€â”€ services/               # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ ai_service.py       # AI è°ƒç”¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ analysis_service.py # åˆ†æä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ export_service.py   # å¯¼å‡ºä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ chat_data_service.py    # å¯¹è¯æ•°æ®æœåŠ¡
â”‚   â”‚   â””â”€â”€ chat_prompt_service.py  # å¯¹è¯æç¤ºè¯æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ analysis/               # æ•°æ®åˆ†ææ¨¡å— (éAI)
â”‚   â”‚   â”œâ”€â”€ processor.py        # DataProcessor: Excelè§£æã€æ•°æ®æ¸…æ´—
â”‚   â”‚   â”œâ”€â”€ calculator.py       # MetricsCalculator: ç»Ÿè®¡é‡è®¡ç®—
â”‚   â”‚   â”œâ”€â”€ anomaly.py          # AnomalyDetector: å¼‚å¸¸æ£€æµ‹
â”‚   â”‚   â””â”€â”€ aggregator.py       # AnalysisAggregator: æ•°æ®èšåˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ ai/                     # AI Provider æŠ½è±¡å±‚
â”‚   â”‚   â”œâ”€â”€ base.py             # BaseAIProvider åŸºç±», AIResponse
â”‚   â”‚   â”œâ”€â”€ factory.py          # AIProviderFactory å·¥å‚æ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ deepseek.py         # DeepSeek Provider
â”‚   â”‚   â”œâ”€â”€ openai.py           # OpenAI Provider
â”‚   â”‚   â”œâ”€â”€ iflow.py            # iFlow Provider (Kimi)
â”‚   â”‚   â””â”€â”€ prompts.py          # Prompt æ¨¡æ¿
â”‚   â”‚
â”‚   â”œâ”€â”€ tasks/                  # Celery å¼‚æ­¥ä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ celery_app.py       # Celery é…ç½® + å¯ç”¨æ€§æ£€æŸ¥
â”‚   â”‚   â”œâ”€â”€ dataset_tasks.py    # æ•°æ®é›†è§£æä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ analysis_tasks.py   # åˆ†æä»»åŠ¡
â”‚   â”‚   â”œâ”€â”€ ai_tasks.py         # AI è°ƒç”¨ä»»åŠ¡
â”‚   â”‚   â””â”€â”€ export_tasks.py     # å¯¼å‡ºä»»åŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ crawlers/               # ç½‘é¡µçˆ¬è™«
â”‚   â”‚   â””â”€â”€ poizon_fetcher.py   # å¾—ç‰©é“¾æ¥å…ƒæ•°æ®æŠ“å–
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                   # æ ¸å¿ƒé…ç½®
â”‚   â”‚   â”œâ”€â”€ config.py           # Settings ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”‚   â”œâ”€â”€ security.py         # JWT è®¤è¯ / å¯†ç å“ˆå¸Œ
â”‚   â”‚   â””â”€â”€ exceptions.py       # è‡ªå®šä¹‰å¼‚å¸¸
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                     # æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ base.py             # Base å£°æ˜åŸºç±»
â”‚   â”‚   â””â”€â”€ session.py          # async_session_maker
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ excel.py            # Excel è¯»å–å’Œå¯¼å‡º
â”‚   â”‚   â””â”€â”€ validators.py       # æ•°æ®æ ¡éªŒ
â”‚   â”‚
â”‚   â””â”€â”€ main.py                 # FastAPI åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ alembic/                    # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ versions/
â”‚       â”œâ”€â”€ 001_initial.py                      # åˆå§‹åŒ–æ‰€æœ‰è¡¨
â”‚       â”œâ”€â”€ 002_add_perf_indexes.py             # æ€§èƒ½ç´¢å¼•
â”‚       â”œâ”€â”€ 003_add_screenshot_analyses.py      # æˆªå›¾åˆ†æè¡¨
â”‚       â”œâ”€â”€ 005_add_conversations.py            # å¯¹è¯åŠŸèƒ½è¡¨
â”‚       â””â”€â”€ 20251228_add_post_content_fields.py # å†…å®¹å­—æ®µæ‰©å±•
â”‚
â”œâ”€â”€ scripts/                    # è„šæœ¬
â”‚   â”œâ”€â”€ init_db.py              # åˆå§‹åŒ–æ•°æ®åº“
â”‚   â”œâ”€â”€ create_user.py          # åˆ›å»ºæµ‹è¯•ç”¨æˆ· (admin/admin123)
â”‚   â””â”€â”€ add_iflow_columns.py    # æ·»åŠ  iFlow å­—æ®µ
â”‚
â”œâ”€â”€ uploads/                    # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ exports/                # å¯¼å‡ºæ–‡ä»¶ç›®å½•
â”‚
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ run.py                      # å¯åŠ¨è„šæœ¬
â””â”€â”€ .env.example
```

### å‰ç«¯ç»“æ„ (`/frontend`)
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/                    # API è¯·æ±‚å°è£…
â”‚   â”‚   â”œâ”€â”€ index.ts            # Axios å®ä¾‹ (æ‹¦æˆªå™¨ã€é‡è¯•ã€é”™è¯¯å¤„ç†)
â”‚   â”‚   â”œâ”€â”€ auth.ts             # è®¤è¯ API
â”‚   â”‚   â”œâ”€â”€ datasets.ts         # æ•°æ®é›† API
â”‚   â”‚   â”œâ”€â”€ analyses.ts         # åˆ†æ API
â”‚   â”‚   â”œâ”€â”€ posts.ts            # ç¬”è®° API
â”‚   â”‚   â”œâ”€â”€ exports.ts          # å¯¼å‡º API
â”‚   â”‚   â”œâ”€â”€ chat.ts             # å¯¹è¯ API (æ”¯æŒæµå¼)
â”‚   â”‚   â”œâ”€â”€ screenshots.ts      # æˆªå›¾åˆ†æ API
â”‚   â”‚   â””â”€â”€ settings.ts         # è®¾ç½® API
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                 # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ auth.ts             # è®¤è¯çŠ¶æ€ (token, user, login/logout)
â”‚   â”‚   â”œâ”€â”€ dataset.ts          # æ•°æ®é›†çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ analysis.ts         # åˆ†æçŠ¶æ€
â”‚   â”‚   â””â”€â”€ chat.ts             # å¯¹è¯çŠ¶æ€
â”‚   â”‚
â”‚   â”œâ”€â”€ router/                 # Vue Router è·¯ç”±
â”‚   â”‚   â””â”€â”€ index.ts            # è·¯ç”±é…ç½® + å¯¼èˆªå®ˆå«
â”‚   â”‚
â”‚   â”œâ”€â”€ views/                  # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ LoginView.vue           # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ DatasetsView.vue        # æ•°æ®é›†åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ AnalysesView.vue        # åˆ†æåˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ AnalysisConfigView.vue  # åˆ†æé…ç½®
â”‚   â”‚   â”œâ”€â”€ AnalysisResultView.vue  # åˆ†æç»“æœå±•ç¤º
â”‚   â”‚   â”œâ”€â”€ PostDetailView.vue      # ç¬”è®°è¯¦æƒ…
â”‚   â”‚   â”œâ”€â”€ ExportView.vue          # å¯¼å‡ºç®¡ç†
â”‚   â”‚   â”œâ”€â”€ ScreenshotView.vue      # æˆªå›¾åˆ†æ
â”‚   â”‚   â”œâ”€â”€ SettingsView.vue        # ç”¨æˆ·è®¾ç½®
â”‚   â”‚   â””â”€â”€ ChatView.vue            # AIå¯¹è¯
â”‚   â”‚
â”‚   â”œâ”€â”€ components/             # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â””â”€â”€ MainLayout.vue  # ä¸»å¸ƒå±€ (å¯¼èˆªæ /ä¾§è¾¹æ )
â”‚   â”‚   â”œâ”€â”€ common/             # é€šç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ charts/             # å›¾è¡¨ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                  # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ index.ts            # æ‰€æœ‰ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ assets/                 # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â”‚       â””â”€â”€ main.scss       # å…¨å±€æ ·å¼
â”‚   â”‚
â”‚   â”œâ”€â”€ App.vue                 # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ main.ts                 # åº”ç”¨å…¥å£
â”‚
â”œâ”€â”€ public/
â”œâ”€â”€ index.html
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ Dockerfile
```

---

## æ•°æ®åº“è®¾è®¡

### æ•°æ®åº“è¡¨ç»“æ„

| è¡¨å | è¯´æ˜ | å…³é”®å­—æ®µ |
|------|------|----------|
| `users` | ç”¨æˆ·è¡¨ | id (UUID), username, email, hashed_password, is_active |
| `user_settings` | ç”¨æˆ·è®¾ç½® | user_id, ai_provider, deepseek_api_key, openai_api_key, iflow_api_key |
| `datasets` | æ•°æ®é›† | id, user_id, name, file_path, status, row_count, progress |
| `posts` | ç¬”è®°æ•°æ® | id, dataset_id, data_id, publish_time, å†…å®¹å­—æ®µ, 7å¤©/14å¤©æŒ‡æ ‡ |
| `analyses` | åˆ†æä»»åŠ¡ | id, dataset_id, user_id, status, config (JSON), progress |
| `analysis_results` | åˆ†æç»“æœ | id, analysis_id, post_id, performance, result_data (JSON) |
| `ai_outputs` | AIè¾“å‡º | id, analysis_result_id, summary, strengths, weaknesses, suggestions |
| `conversations` | å¯¹è¯ | id, user_id, title, context_type, context_analysis_id |
| `conversation_messages` | å¯¹è¯æ¶ˆæ¯ | id, conversation_id, role, content, tokens_used |
| `exports` | å¯¼å‡ºè®°å½• | id, analysis_id, user_id, file_path, format, status |
| `screenshot_analyses` | æˆªå›¾åˆ†æ | id, user_id, image_path, analysis_result |

### æ•°æ®åº“å…³ç³»å›¾

```
users (1) â”€â”€â”€â”€â”€â”€< (N) datasets
users (1) â”€â”€â”€â”€â”€â”€< (N) analyses
users (1) â”€â”€â”€â”€â”€â”€< (N) exports
users (1) â”€â”€â”€â”€â”€â”€< (1) user_settings
users (1) â”€â”€â”€â”€â”€â”€< (N) conversations

datasets (1) â”€â”€â”€â”€â”€â”€< (N) posts
datasets (1) â”€â”€â”€â”€â”€â”€< (N) analyses

analyses (1) â”€â”€â”€â”€â”€â”€< (N) analysis_results
analyses (1) â”€â”€â”€â”€â”€â”€< (N) exports

posts (1) â”€â”€â”€â”€â”€â”€< (N) analysis_results
analysis_results (1) â”€â”€â”€â”€â”€â”€< (1) ai_outputs

conversations (1) â”€â”€â”€â”€â”€â”€< (N) conversation_messages
```

### æ€§èƒ½ç´¢å¼•

| ç´¢å¼•å | è¡¨ | å­—æ®µ | ç”¨é€” |
|--------|-----|------|------|
| ix_datasets_user_id_created_at | datasets | user_id, created_at | æŒ‰ç”¨æˆ·å’Œæ—¶é—´æŸ¥è¯¢ |
| ix_posts_dataset_id | posts | dataset_id | æŒ‰æ•°æ®é›†æŸ¥è¯¢ç¬”è®° |
| ix_analyses_user_id_created_at | analyses | user_id, created_at | æŒ‰ç”¨æˆ·å’Œæ—¶é—´æŸ¥è¯¢ |
| ix_analyses_user_id_dataset_id_created_at | analyses | user_id, dataset_id, created_at | ç»„åˆæŸ¥è¯¢ |
| ix_analysis_results_analysis_id_created_at | analysis_results | analysis_id, created_at | æŒ‰åˆ†ææŸ¥è¯¢ç»“æœ |
| ix_analysis_results_analysis_id_performance | analysis_results | analysis_id, performance | æŒ‰è¡¨ç°ç­›é€‰ |

---

## API æ¥å£è®¾è®¡

### è®¤è¯æ¥å£ (`/api/v1/auth`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/register` | ç”¨æˆ·æ³¨å†Œ |
| POST | `/login` | ç”¨æˆ·ç™»å½• (è¿”å› JWT token) |
| GET | `/me` | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |

### æ•°æ®é›†æ¥å£ (`/api/v1/datasets`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/upload` | ä¸Šä¼  Excel æ–‡ä»¶ |
| GET | `/` | è·å–æ•°æ®é›†åˆ—è¡¨ (åˆ†é¡µ) |
| GET | `/{id}` | è·å–æ•°æ®é›†è¯¦æƒ… |
| DELETE | `/{id}` | åˆ é™¤æ•°æ®é›† |

### åˆ†ææ¥å£ (`/api/v1/analyses`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/` | åˆ›å»ºåˆ†æä»»åŠ¡ |
| GET | `/` | è·å–åˆ†æåˆ—è¡¨ |
| GET | `/{id}` | è·å–åˆ†æè¯¦æƒ… |
| GET | `/{id}/results` | è·å–åˆ†æç»“æœ (å¯æŒ‰ performance ç­›é€‰) |
| POST | `/{id}/ai` | è§¦å‘ AI åˆ†æ |

### ç¬”è®°æ¥å£ (`/api/v1/posts`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/{post_id}` | è·å–ç¬”è®°è¯¦æƒ… |
| GET | `/{post_id}/ai-output` | è·å–ç¬”è®° AI è¾“å‡º |

### å¯¹è¯æ¥å£ (`/api/v1/chat`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/conversations` | åˆ›å»ºå¯¹è¯ |
| GET | `/conversations` | è·å–å¯¹è¯åˆ—è¡¨ |
| GET | `/conversations/{id}` | è·å–å¯¹è¯è¯¦æƒ… |
| POST | `/conversations/{id}/messages` | å‘é€æ¶ˆæ¯ (æ”¯æŒæµå¼å“åº”) |
| GET | `/conversations/{id}/messages` | è·å–æ¶ˆæ¯å†å² |

### å¯¼å‡ºæ¥å£ (`/api/v1/exports`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/analyses/{id}/export` | åˆ›å»ºå¯¼å‡ºä»»åŠ¡ |
| GET | `/{id}/download` | ä¸‹è½½å¯¼å‡ºæ–‡ä»¶ |

### è®¾ç½®æ¥å£ (`/api/v1/settings`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/` | è·å–ç”¨æˆ·è®¾ç½® |
| PUT | `/` | æ›´æ–°ç”¨æˆ·è®¾ç½® |
| POST | `/test-api-key` | æµ‹è¯• API å¯†é’¥è¿æ¥ |

### æˆªå›¾åˆ†ææ¥å£ (`/api/v1/screenshots`)
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/analyze` | ä¸Šä¼ æˆªå›¾è¿›è¡Œåˆ†æ |
| GET | `/` | è·å–æˆªå›¾åˆ†æå†å² |

---

## å‰ç«¯è·¯ç”±ç»“æ„

```
/login                          # ç™»å½•é¡µ (æ— éœ€è®¤è¯)
/                               # ä¸»å¸ƒå±€ (éœ€è¦è®¤è¯)
â”œâ”€â”€ /datasets                   # æ•°æ®é›†åˆ—è¡¨
â”œâ”€â”€ /analyses                   # åˆ†æåˆ—è¡¨
â”œâ”€â”€ /analyses/:id/config        # åˆ†æé…ç½®
â”œâ”€â”€ /analyses/:id/results       # åˆ†æç»“æœ
â”œâ”€â”€ /posts/:id                  # ç¬”è®°è¯¦æƒ…
â”œâ”€â”€ /exports                    # å¯¼å‡ºç®¡ç†
â”œâ”€â”€ /screenshot                 # æˆªå›¾åˆ†æ
â”œâ”€â”€ /settings                   # ç”¨æˆ·è®¾ç½®
â””â”€â”€ /chat/:id                   # AIå¯¹è¯
```

---

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—åˆ†æ

### æ•°æ®å¤„ç†æ¨¡å— (`analysis/processor.py`)

**Excel åˆ—åæ˜ å°„ï¼š**
```python
COLUMN_MAPPING = {
    'data_id': 'data_id',
    'æ ‡é¢˜': 'content_title',
    'å‘æ–‡æ—¶é—´': 'publish_time',
    'å‘æ–‡é“¾æ¥': 'publish_link',
    'å†…å®¹å½¢å¼': 'content_type',
    'å‘æ–‡ç±»å‹': 'post_type',
    'ç´ ææ¥æº': 'source',
    'æ¬¾å¼ä¿¡æ¯': 'style_info',
    '7å¤©é˜…è¯»/æ’­æ”¾': 'read_7d',
    '7å¤©äº’åŠ¨': 'interact_7d',
    '7å¤©å¥½ç‰©è®¿é—®': 'visit_7d',
    '7å¤©å¥½ç‰©æƒ³è¦': 'want_7d',
    '14å¤©é˜…è¯»/æ’­æ”¾': 'read_14d',
    '14å¤©äº’åŠ¨': 'interact_14d',
    '14å¤©å¥½ç‰©è®¿é—®': 'visit_14d',
    '14å¤©å¥½ç‰©æƒ³è¦': 'want_14d',
}
```

**å¤„ç†æµç¨‹ï¼š**
1. `rename_columns()` - é‡å‘½ååˆ—
2. `clean_numeric_columns()` - æ¸…æ´—æ•°å€¼å‹åˆ—
3. `parse_datetime()` - è§£ææ—¥æœŸæ—¶é—´
4. `handle_missing_values()` - å¤„ç†ç¼ºå¤±å€¼
5. `validate()` - æ•°æ®éªŒè¯

### æŒ‡æ ‡è®¡ç®—æ¨¡å— (`analysis/calculator.py`)

- **åŸºç¡€ç»Ÿè®¡é‡**: mean, median, std, min, max, q25, q75, q10, q90
- **ç™¾åˆ†ä½æ’å**: è®¡ç®—æ¯ä¸ªæŒ‡æ ‡åœ¨æ•°æ®é›†ä¸­çš„æ’å
- **åŸºå‡†æ¯”è¾ƒ**: ä¸å‡å€¼/ä¸­ä½æ•°çš„ç™¾åˆ†æ¯”å·®å¼‚

### å¼‚å¸¸æ£€æµ‹æ¨¡å— (`analysis/anomaly.py`)

- **çªå‡ºæŒ‡æ ‡**: >= 90åˆ†ä½æ•°
- **é—®é¢˜æŒ‡æ ‡**: <= 10åˆ†ä½æ•°
- **è¡¨ç°è¯„çº§**:
  - ä¼˜ç§€: >= 1.5x å¹³å‡å€¼
  - æ­£å¸¸: >= 1.0x å¹³å‡å€¼
  - åä½: >= 0.5x å¹³å‡å€¼
  - è¾ƒå·®: < 0.5x å¹³å‡å€¼

### AI Provider æŠ½è±¡å±‚ (`ai/`)

**åŸºç±»è®¾è®¡ï¼š**
```python
class BaseAIProvider(ABC):
    @abstractmethod
    async def generate(self, prompt: str) -> str: pass
    
    @abstractmethod
    async def analyze_post(self, input_data: Dict) -> AIResponse: pass
    
    async def chat_stream(self, messages, system_prompt) -> AsyncGenerator[str, None]: pass
    
    async def chat(self, messages, system_prompt) -> str: pass
```

**å·¥å‚æ¨¡å¼ï¼š**
```python
AIProviderFactory.create(provider_name, api_key)
# æ”¯æŒ: 'deepseek', 'openai', 'iflow'
```

### Celery å¼‚æ­¥ä»»åŠ¡ (`tasks/`)

| ä»»åŠ¡ | è¯´æ˜ |
|------|------|
| `parse_dataset_task` | è§£æExcelæ•°æ®é›† |
| `analyze_dataset_task` | æ‰§è¡Œæ•°æ®åˆ†æ |
| `generate_ai_output_task` | ç”ŸæˆAIè¾“å‡º |
| `export_analysis_task` | å¯¼å‡ºåˆ†ææŠ¥å‘Š |

**ç‰¹ç‚¹ï¼š**
- æ”¯æŒ Celery worker ä¸å¯ç”¨æ—¶é™çº§ä¸ºåå°çº¿ç¨‹
- ä»»åŠ¡è¿›åº¦è·Ÿè¸ª (0% - 100%)
- é”™è¯¯é‡è¯•æœºåˆ¶

---

## éƒ¨ç½²é…ç½®

### Docker Compose æœåŠ¡

```yaml
services:
  postgres:       # PostgreSQL 15 (ç«¯å£ 5433)
  redis:          # Redis 7 (ç«¯å£ 6380)
  backend:        # FastAPI (ç«¯å£ 8000)
  celery-worker:  # Celery Worker
  frontend:       # Nginx + Vue (ç«¯å£ 80)
```

### ç¯å¢ƒå˜é‡é…ç½®

**åç«¯ (.env):**
```bash
DATABASE_URL=postgresql+asyncpg://postgres:postgres@127.0.0.1:5433/content_analytics
REDIS_URL=redis://127.0.0.1:6380/0
SECRET_KEY=your-secret-key
AI_PROVIDER=deepseek
DEEPSEEK_API_KEY=sk-xxx
OPENAI_API_KEY=sk-xxx
```

**å‰ç«¯ (.env):**
```bash
VITE_API_BASE_URL=http://localhost:8000/api/v1
```

### å¯åŠ¨æµç¨‹

**å¼€å‘ç¯å¢ƒï¼š**
```bash
# 1. å¯åŠ¨åŸºç¡€æœåŠ¡
docker-compose -f docker-compose.dev.yml up -d

# 2. åç«¯å¯åŠ¨
cd backend
pip install -r requirements.txt
python scripts/init_db.py
python scripts/create_user.py  # admin/admin123
uvicorn app.main:app --reload

# 3. Celery Worker (æ–°ç»ˆç«¯)
celery -A app.tasks.celery_app worker --loglevel=info --pool=solo

# 4. å‰ç«¯å¯åŠ¨ (æ–°ç»ˆç«¯)
cd frontend
npm install
npm run dev
```

**ç”Ÿäº§éƒ¨ç½²ï¼š**
```bash
docker-compose up -d --build
```

### è®¿é—®åœ°å€

| æœåŠ¡ | åœ°å€ |
|------|------|
| å‰ç«¯ | http://localhost:3000 (å¼€å‘) / http://localhost:80 (ç”Ÿäº§) |
| åç«¯ API | http://localhost:8000 |
| API æ–‡æ¡£ | http://localhost:8000/api/docs |
| é»˜è®¤è´¦å· | admin / admin123 |

---

## æŠ€æœ¯äº®ç‚¹

1. **å¼‚æ­¥æ¶æ„** - FastAPI + asyncio + Celery å®ç°é«˜å¹¶å‘
2. **AI Provider æŠ½è±¡** - å·¥å‚æ¨¡å¼æ”¯æŒå¤šä¸ª AI æœåŠ¡å•†åˆ‡æ¢
3. **æµå¼èŠå¤©** - SSE å®ç°å®æ—¶æ¶ˆæ¯æµ
4. **æ•°æ®çˆ¬è™«** - Playwright è‡ªåŠ¨æŠ“å–å¤–é“¾å…ƒæ•°æ®
5. **åå°çº¿ç¨‹é™çº§** - Celery ä¸å¯ç”¨æ—¶è‡ªåŠ¨ä½¿ç”¨çº¿ç¨‹å¤„ç†
6. **å®Œæ•´é”™è¯¯å¤„ç†** - å…¨å±€å¼‚å¸¸å¤„ç† + è¯¦ç»†é”™è¯¯ä¿¡æ¯
7. **æ€§èƒ½ä¼˜åŒ–** - æ•°æ®åº“è¿æ¥æ±  + ç´¢å¼•ä¼˜åŒ– + åˆ†é¡µæŸ¥è¯¢
8. **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰

---

## å®‰å…¨ç‰¹æ€§

- JWT è®¤è¯ï¼Œtoken æœ‰æ•ˆæœŸ 24 å°æ—¶
- å¯†ç ä½¿ç”¨ BCrypt åŠ å¯†
- API Key ä¸åœ¨æ—¥å¿—ä¸­æ‰“å°
- ç”¨æˆ·æ•°æ®éš”ç¦»ï¼šåªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- CORS é…ç½® (ç”Ÿäº§ç¯å¢ƒéœ€é™åˆ¶å…·ä½“åŸŸå)

---

## æ–‡ä»¶ä¸Šä¼ è§„èŒƒ

- æ”¯æŒæ ¼å¼: `.xlsx`, `.xls`
- æœ€å¤§æ–‡ä»¶å¤§å°: 10MB
- å­˜å‚¨è·¯å¾„: `uploads/{user_id}/{uuid}.xlsx`
- å¯¼å‡ºè·¯å¾„: `uploads/exports/analysis_report_{uuid}_{timestamp}.xlsx`

---

**æŠ¥å‘Šæ›´æ–°æ—¶é—´**: 2026å¹´1æœˆ4æ—¥
